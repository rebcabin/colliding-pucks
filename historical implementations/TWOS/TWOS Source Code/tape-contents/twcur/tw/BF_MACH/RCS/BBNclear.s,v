head     1.4;
branch   ;
access   ;
symbols  TW2_7:1.4 TW2_6:1.4 TW2_5_1:1.3 TW2_5:1.2 TW2_4_2:1.2 TW2_4_1:1.1 TW2_4:1.1;
locks    ; strict;
comment  @| @;


1.4
date     91.11.01.13.19.55;  author pls;  state Rel;
branches ;
next     1.3;

1.3
date     91.07.17.15.51.19;  author judy;  state Rel;
branches ;
next     1.2;

1.2
date     90.12.10.10.59.36;  author configtw;  state Rel;
branches ;
next     1.1;

1.1
date     90.08.07.15.37.31;  author configtw;  state Rel;
branches ;
next     ;


desc
@fast clear for Butterfly
@


1.4
log
@1.  Handle 64K boundary conditions (SCR 165).
@
text
@|	Copyright (C) 1989, 1991, California Institute of Technology.
|	U. S. Government Sponsorship under NASA Contract NAS7-918
|	is acknowledged.


|
| $Log:	BBNclear.s,v $
| Revision 1.3  91/07/17  15:51:19  judy
| New copyright notice.
| 
| Revision 1.2  90/12/10  10:59:36  configtw
| fix 16 bit loop limit problem (Matt)
| 
| Revision 1.1  90/08/07  15:37:31  configtw
| Initial revision
| 

|	clear ( addr, numbytes )

	.text
	.globl	_clear
_clear:
	link	a6,#0
	movl	a6@@(8),a0	| addr
	movl	a6@@(12),d0	| numbytes
	movl	d2,a7@@-
	movl	d1,a7@@-
	movl	#3,d1
	bras	g1
l1:
	clrb	a0@@+
g1:
	movl	a0,d2
	andl	d1,d2
	dbeq	d0,l1
	beqs	notdone2
	swap	d0			| check high 16 bits
	dbf		d0,notdone1
	bras	done
notdone1:				| count > 16 bits
	swap	d0			| swap count back
	andl	d0,d1		| save low order 2 bits of count
	lsrl	#2,d0		| convert to word count
	bras	l2			| start loop with write
notdone2:
	andl	d0,d1
	lsrl	#2,d0
	bras	g2
l20:
	swap	d0			| get low 16 bits again
l2:
	clrl	a0@@+
g2:
	dbf		d0,l2
	swap	d0			| look at high 16 bits
	dbf		d0,l20
	bras	g3
l3:
	clrb	a0@@+
g3:
	dbf		d1,l3

done:
	movl	a7@@+,d1
	movl	a7@@+,d2
	unlk	a6
	rts
@


1.3
log
@New copyright notice.
@
text
@d8 3
d30 4
a33 2
l1:	clrb	a0@@+
g1:	movl	a0,d2
d36 10
a45 1
	bnes	done
d49 8
a56 3
l2:	clrl	a0@@+
g2:	subql	#1,d0
	bges	l2
d58 4
a61 2
l3:	clrb	a0@@+
g3:	dbf	d1,l3
d63 2
a64 1
done:	movl	a7@@+,d1
@


1.2
log
@fix 16 bit loop limit problem (Matt)
@
text
@d1 5
d8 3
a13 4
|
|	Copyright (C) 1989, California Institute of Technology.
|	U. S. Government Sponsorship under NASA Contract NAS7-918
|	is acknowledged.
@


1.1
log
@Initial revision
@
text
@d2 4
a5 1
| $Log$
d32 2
a33 1
g2:	dbf	d0,l2
@
