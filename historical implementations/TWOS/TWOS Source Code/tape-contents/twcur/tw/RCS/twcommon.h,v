head     1.9;
branch   ;
access   ;
symbols  TW2_7:1.9 TW2_6:1.8 TW2_5_1:1.6 TW2_5:1.4 TW2_4_2:1.2 TW2_4_1:1.1 TW2_4:1.1;
locks    ; strict;
comment  @ * @;


1.9
date     91.12.27.09.26.00;  author pls;  state Rel;
branches ;
next     1.8;

1.8
date     91.11.07.08.47.50;  author configtw;  state Rel;
branches ;
next     1.7;

1.7
date     91.11.01.13.13.37;  author pls;  state Dev;
branches ;
next     1.6;

1.6
date     91.07.17.15.13.56;  author judy;  state Rel;
branches ;
next     1.5;

1.5
date     91.07.09.15.35.39;  author steve;  state Dev;
branches ;
next     1.4;

1.4
date     91.06.03.12.27.24;  author configtw;  state Rel;
branches ;
next     1.3;

1.3
date     91.03.26.09.55.35;  author pls;  state Dev;
branches ;
next     1.2;

1.2
date     90.10.15.12.50.15;  author reiher;  state Rel;
branches ;
next     1.1;

1.1
date     90.08.07.15.41.36;  author configtw;  state Rel;
branches ;
next     ;


desc
@Time Warp includes
@


1.9
log
@1.  Combine MAXPKTL's.
2.  Bump Max_Addresses to 120.
3.  Add support for variable address table length (SCR 214).
@
text
@/*      Copyright (C) 1989, 1991, California Institute of Technology.
		U. S. Government Sponsorship under NASA Contract NAS7-918
		is acknowledged.        */

/*
 * $Log:	twcommon.h,v $
 * Revision 1.8  91/11/07  08:47:50  configtw
 * Change Max_Addresses back to 100.
 * 
 * Revision 1.7  91/11/01  13:13:37  pls
 * 1.  Change ifdef's and defines.
 * 2.  Add speculative computing interface support (SCR 172).
 * 3.  Add xTypeArea support.
 * 
 * Revision 1.6  91/07/17  15:13:56  judy
 * New copyright notice.
 * 
 * Revision 1.5  91/07/09  15:35:39  steve
 * added Sun4 Macro's to use bzero, bcopy, and bcmp for clear, entcpy & bytcmp
 * 
 * Revision 1.4  91/06/03  12:27:24  configtw
 * Tab conversion.
 * 
 * Revision 1.3  91/03/26  09:55:35  pls
 * 1.  Change Max_Addresses from 100 to 200.
 * 2.  Change tell to schedule.
 * 3.  Add support for TYPEINIT and library hook.
 * 
 * Revision 1.2  90/10/15  12:50:15  reiher
 * moved FILE_NAME_LENGTH constant from twsys.h
 * 
 * Revision 1.1  90/08/07  15:41:36  configtw
 * Initial revision
 * 
*/

#ifndef TWCOMMON
#define TWCOMMON 1
/*--------------------------------------------------------------------------*
   PORTABLE DATA TYPES
		machine-        machine-
		dependent       independent
		field           type definition
*--------------------------------------------------------------------------*/
typedef long int        Addr;           /* Type of non-aliased address     */
typedef unsigned char   Byte;           /* One-byte integer                */
typedef char            Char;           /* Just for completeness' sake     */
typedef double          Dbl;            /*                                 */
typedef float           Float;          /*                                 */
typedef int            (*pfi)();        /* pointer to function             */
typedef int             Int;            /* standard integer                  */
typedef long int        Long;           /* Hopefully a 4 byte integer      */
typedef unsigned int    Uint;           /*                                 */
typedef unsigned long   Ulong;          /*                                 */
typedef int             Pointer;        /* offset into address table       */

/*--------------------------------------------------------------------------*
   BASIC TIMEWARP DATA TYPES
*--------------------------------------------------------------------------*/
#define NOBJLEN          20 /* Length of an object name                    */
#define TOBJLEN          20 /* Length of an object type name               */
#define FILE_NAME_LENGTH 41 /* Length of a file name                       */
typedef Char            Name_object[ NOBJLEN ];
typedef Char            Type_object[ TOBJLEN ];
typedef Char            Message;

typedef Name_object     Name;   /* TW's names for these types              */
typedef Type_object     Type;   /*  ''    ''   ''   ''    ''               */

typedef double STime;

typedef struct VTimeStruct
{
	STime simtime;
	Ulong sequence1;
	Ulong sequence2;
}
	VTime;

/*--------------------------------------------------------------------------*
   UID -- SYSTEM-WIDE UNIQUE ID (MESSAGES, PROCESSES, GROUPS, ETC.)
*--------------------------------------------------------------------------*/

typedef struct uid_str {
	long  num ;                 /*                                         */
	Int   node ;                /* For message id only.                    */
	}                   Uid;

typedef struct	msgRefStr
	{							/* used for message cancellation */
	Name	rcver;				/* name of receiving object */
	VTime	rcvtim;				/* receive time of message */
	Uid		gid;				/* unique message id */
	}	msgRef;

#define POSINF 999999999.0      /* positive infinity for virtual time */
#define NEGINF -999999999.0     /* negative infinity for virtual time */

#define MAXINT 0x7fffffff

#define MAXPKTL         556     /* maximum message packet length */
#if SIMULATOR
#define MINPKTL         256     /* minimum pktlen for TW proper */
#else
#define MINPKTL         540
#endif

#define MAX_TW_STREAMS  5       /* maximum file streams per object */
#define MAX_TW_FILES    60      /* maximum input files for getfile */
#define SEG_TABLE_INCREMENT 20	/* enlarge seg table by this much */
#define Max_Addresses   120     /* maximum allocated blocks per object */
#define MAXMSGS         500     /* maximum messages per event */

#define SUCCESS           0 /* only one way to succeed                     */
#define FAILURE           1 /* anything else is failure                    */

#ifdef  TRUE                /* This is to avoid an illegal redefinition    */
							/* error on the Butterfly.                     */
#undef  TRUE
#undef  FALSE
#endif

#define TRUE              1 /* Values of "Logical" type                    */
#define FALSE             0 /*                                             */

#define CRITICAL        1       /* critical memory allocation */
#define NONCRITICAL     0       /* non-critical memory allocation */

#define YES      1
#define NO       0

#define ON       1
#define OFF      0

#ifndef NULL
#define NULL            0
#endif

#define tell schedule

void *type_Area();
void *type_malloc();
void *type_myArea();

#define myTypeArea      (type_myArea())
#define xTypeArea(x)	(type_Area(x))
#define typeMalloc(x)   (type_malloc(x))

VTime obj_now();
char *obj_myName();
void *obj_myState();
int   obj_numMsgs();

#define myName(x) (obj_myName(x))
#define myState (obj_myState())
#define numMsgs (obj_numMsgs())

msgRef	delObj();
msgRef	newObj();
msgRef	schedule();

#define msgRefRcvr(x)		(x.rcver)
#define msgRefRcvTime(x)	(x.rcvtim)
#define msgRefUID(x)		(x.gid)

#define MY(x) (((State *)obj_myState())->x)

void * msgText ();
char * msgSender ();
Long   msgSelector ();
int    msgLength ();
void * pointerPtr ();
Pointer newBlockPtr ();

typedef struct
{
	char *type;
	pfi init;
	pfi event;
	pfi term;
	pfi displayMsg;
	pfi displayState;
	int statesize;
	void* (*initType)();        /* pointer to type init routine */
	Ulong libBits;              /* 1 bit reserved for each library routine */
}
  ObjectType;

VTime newVTime ();
VTime SetSimTime ();
VTime SetSequence1 ();
VTime SetSequence2 ();
VTime sscanVTime ();
VTime IncSimTime ();
VTime IncSequence1 ();
VTime IncSequence2 ();

#include "vtime.h"

#if OLDTW
typedef int Vtime;
#define now (obj_nowI())
#define tell(rcver,rcvtim,sel,len,text) tellI(rcver,rcvtim,sel,len,text)
#define msgSendTime(i) ((Vtime)msgSendTimeI(i))
#define newObj(rcver,rcvtim,objtype) newObjI(rcver,rcvtim,objtype)
#define delObj(rcver,rcvtim) delObjI(rcver,rcvtim)
#else
#define now (obj_now())
VTime  msgSendTime ();
#endif

int tw_packetLen ();
#endif

#if SUN4
#define clear(addr,numbytes) bzero(addr,numbytes)
#define entcpy(dest,src,numbytes) bcopy(src,dest,numbytes)
#define bytcmp(a,b,len) bcmp(b,a,len)
#endif
@


1.8
log
@Change Max_Addresses back to 100.
@
text
@d7 3
d101 1
a102 1
#define MAXPKTL         500     /* maximum message packet length */
a104 1
#define MAXPKTL         556
d110 2
a111 1
#define Max_Addresses   100     /* maximum allocated blocks per object */
@


1.7
log
@1.  Change ifdef's and defines.
2.  Add speculative computing interface support (SCR 172).
3.  Add xTypeArea support.
@
text
@d7 5
d108 1
a108 1
#define Max_Addresses   200     /* maximum allocated blocks per object */
@


1.6
log
@New copyright notice.
@
text
@d7 3
d30 1
a30 1
#define TWCOMMON
d72 16
d93 1
a93 4
#ifdef SIMULATOR
#ifdef MODSIM
#define MAXPKTL         1100    /* maximum message packet length */
#else
a94 1
#endif
d133 1
d138 1
d150 8
d192 1
a192 1
#ifdef OLDTW
d207 1
a207 1
#ifdef SUN4
@


1.5
log
@added Sun4 Macro's to use bzero, bcopy, and bcmp for clear, entcpy & bytcmp
@
text
@d1 4
d7 3
a24 3
/*      Copyright (C) 1989, California Institute of Technology.
		U. S. Government Sponsorship under NASA Contract NAS7-918
		is acknowledged.        */
@


1.4
log
@Tab conversion.
@
text
@d2 4
a5 1
 * $Log:        twcommon.h,v $
d176 6
@


1.3
log
@1.  Change Max_Addresses from 100 to 200.
2.  Change tell to schedule.
3.  Add support for TYPEINIT and library hook.
@
text
@d2 6
a7 1
 * $Log:	twcommon.h,v $
d15 3
a17 3
/*	Copyright (C) 1989, California Institute of Technology.
	U. S. Government Sponsorship under NASA Contract NAS7-918
	is acknowledged.	*/
d23 3
a25 3
        machine-        machine-
        dependent       independent
        field           type definition
d37 1
a37 1
typedef int		Pointer;	/* offset into address table	   */
d44 1
a44 1
#define FILE_NAME_LENGTH 41 /* Length of a file name 			   */
d56 3
a58 3
    STime simtime;
    Ulong sequence1;
    Ulong sequence2;
d60 1
a60 1
    VTime;
d62 2
a63 2
#define POSINF 999999999.0	/* positive infinity for virtual time */
#define NEGINF -999999999.0	/* negative infinity for virtual time */
d69 1
a69 1
#define MAXPKTL		1100	/* maximum message packet length */
d71 1
a71 1
#define MAXPKTL		500	/* maximum message packet length */
d73 1
a73 1
#define MINPKTL		256	/* minimum pktlen for TW proper */
d75 2
a76 2
#define	MAXPKTL		556
#define	MINPKTL		540
d79 4
a82 4
#define MAX_TW_STREAMS	5	/* maximum file streams per object */
#define MAX_TW_FILES	60	/* maximum input files for getfile */
#define Max_Addresses	200	/* maximum allocated blocks per object */
#define MAXMSGS		500	/* maximum messages per event */
d84 2
a85 2
#define SUCCESS           0 /* only one way to succeed			   */
#define FAILURE           1 /* anything else is failure			   */
d87 2
a88 2
#ifdef  TRUE		    /* This is to avoid an illegal redefinition    */
			    /* error on the Butterfly.                     */
d96 2
a97 2
#define CRITICAL	1	/* critical memory allocation */
#define NONCRITICAL	0	/* non-critical memory allocation */
d114 2
a115 2
#define myTypeArea	(type_myArea())
#define typeMalloc(x)	(type_malloc(x))
d123 2
a124 2
#define myState	(obj_myState())
#define numMsgs	(obj_numMsgs())
d137 9
a145 9
    char *type;
    pfi init;
    pfi event;
    pfi term;
    pfi displayMsg;
    pfi displayState;
    int statesize;
    void* (*initType)();	/* pointer to type init routine */
    Ulong libBits;		/* 1 bit reserved for each library routine */
@


1.2
log
@moved FILE_NAME_LENGTH constant from twsys.h
@
text
@d3 3
d76 1
a76 1
#define Max_Addresses	100	/* maximum allocated blocks per object */
d104 8
d139 2
@


1.1
log
@Initial revision
@
text
@d2 4
a5 1
 * $Log$
d36 1
@
